SELECT DISTINCT p.ir_id
INTO #patients
FROM fact.vw_diagnosis_event de JOIN dim.vw_diagnosis_event_profile dep ON de.diagnosis_event_profile_key = dep.diagnosis_event_profile_key
                                JOIN dim.vw_diagnosis_terminology dt ON de.diagnosis_key = dt.diagnosis_key
                                JOIN dim.vw_patient p ON de.patient_key = p.patient_key
                                LEFT JOIN fsm_analytics.fsm_ids_dm.mrd_pt_id_mapping map ON p.ir_id = map.ir_id
WHERE de.is_primary_diagnosis = 1
AND
(
  (
    dt.diagnosis_code_set = 'ICD-9-CM' AND
    dt.diagnosis_code IN(
                          '142.0',
                          '160',
                          '160.4',
                          '170',
                          '170.2',
                          '170.9',
                          '171',
                          '171.9',
                          '190.2',
                          '191',
                          '191.1',
                          '191.2',
                          '191.3',
                          '191.4',
                          '191.5',
                          '191.6',
                          '191.7',
                          '191.8',
                          '191.9',
                          '192',
                          '192.1',
                          '192.2',
                          '192.3',
                          '192.8',
                          '192.9',
                          '194.3',
                          '194.4',
                          '195',
                          '196',
                          '198.3',
                          '198.4',
                          '198.5',
                          '198.89',
                          '199',
                          '199.1',
                          '200',
                          '200.5',
                          '202.8',
                          '210.2',
                          '210.7',
                          '213',
                          '213.2',
                          '213.9',
                          '215',
                          '215.9',
                          '225',
                          '225.1',
                          '225.2',
                          '225.3',
                          '225.4',
                          '225.8',
                          '225.9',
                          '227.3',
                          '227.4',
                          '227.5',
                          '227.6',
                          '228.02',
                          '234.8',
                          '237',
                          '237.1',
                          '237.2',
                          '237.3',
                          '237.4',
                          '237.5',
                          '237.6',
                          '237.7',
                          '237.7',
                          '237.71',
                          '237.72',
                          '237.73',
                          '237.79',
                          '237.9',
                          '238.1',
                          '239.6',
                          '239.7',
                          '253.8',
                          '324',
                          '324.1',
                          '324.9',
                          '336.9',
                          '348.89',
                          '759.5',
                          '759.6',
                          'V12.41',
                          'V58.11'
                        )
  )
  OR
  (
    dt.diagnosis_code_set = 'ICD-10-CM' AND
    dt.diagnosis_code IN(
                          'C07',
                          'C30.0',
                          'C31.2',
                          'C41.0',
                          'C41.2',
                          'C41.9',
                          'C49.0',
                          'C49.9',
                          'C69.50',
                          'C71.0',
                          'C71.1',
                          'C71.2',
                          'C71.3',
                          'C71.4',
                          'C71.5',
                          'C71.6',
                          'C71.7',
                          'C71.8',
                          'C71.9',
                          'C72.20',
                          'C72.21',
                          'C72.22',
                          'C72.30',
                          'C72.31',
                          'C72.32',
                          'C72.40',
                          'C72.41',
                          'C72.42',
                          'C72.50',
                          'C72.59',
                          'C70.0',
                          'C70.9',
                          'C72.0',
                          'C72.1',
                          'C70.1',
                          'C72.9',
                          'C72.9',
                          'C75.1',
                          'C75.2',
                          'C75.3',
                          'C75.4',
                          'C75.5',
                          'C76.0',
                          'C77.0',
                          'C79.31',
                          'C79.32',
                          'C79.40',
                          'C79.49',
                          'C79.51',
                          'C79.52',
                          'C79.89',
                          'C80.0',
                          'C80.1',
                          'C83.30',
                          'C83.39',
                          'C83.80',
                          'C83.89',
                          'C85.80',
                          'C85.89',
                          'D11.7',
                          'D11.9',
                          'D10.6',
                          'D16.4',
                          'D16.6',
                          'D16.9',
                          'D21.0',
                          'D21.9',
                          'D33.0',
                          'D33.1',
                          'D33.2',
                          'D33.3',
                          'D32.0',
                          'D32.9',
                          'D33.4',
                          'D32.1',
                          'D33.7',
                          'D33.9',
                          'D35.2',
                          'D35.3',
                          'D35.4',
                          'D35.5',
                          'D35.6',
                          'D18.02',
                          'D09.3',
                          'D09.8',
                          'D44.3',
                          'D44.4',
                          'D44.5',
                          'D44.10',
                          'D44.6',
                          'D44.7',
                          'D44.0',
                          'D44.2',
                          'D43.0',
                          'D43.1',
                          'D43.2',
                          'D43.4',
                          'D42.0',
                          'D42.1',
                          'D42.9',
                          'Q85.00',
                          'Q85.00',
                          'Q85.01',
                          'Q85.02',
                          'Q85.03',
                          'Q85.09',
                          'D43.3',
                          'D43.8',
                          'D43.9',
                          'D48.1',
                          'D49.6',
                          'D49.7',
                          'E23.6',
                          'E24.1',
                          'G06.0',
                          'G06.1',
                          'G06.2',
                          'G95.9',
                          'G93.89',
                          'Q85.1',
                          'Q85.8',
                          'Z86.011',
                          'Z51.11'
                        )
  )
)
